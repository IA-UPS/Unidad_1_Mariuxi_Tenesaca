<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Mariuxi Maribel Tenesaca Yuqui">

<title>Informe de regresión lineal simple y múltiple: Resumen, Laboratorio Capítulos 2 y 3 ( An Introduction to Statistical Learning)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Informe de regresión lineal simple y múltiple cap 2 3 y ejercicio cap 3_files/libs/clipboard/clipboard.min.js"></script>
<script src="Informe de regresión lineal simple y múltiple cap 2 3 y ejercicio cap 3_files/libs/quarto-html/quarto.js"></script>
<script src="Informe de regresión lineal simple y múltiple cap 2 3 y ejercicio cap 3_files/libs/quarto-html/popper.min.js"></script>
<script src="Informe de regresión lineal simple y múltiple cap 2 3 y ejercicio cap 3_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Informe de regresión lineal simple y múltiple cap 2 3 y ejercicio cap 3_files/libs/quarto-html/anchor.min.js"></script>
<link href="Informe de regresión lineal simple y múltiple cap 2 3 y ejercicio cap 3_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Informe de regresión lineal simple y múltiple cap 2 3 y ejercicio cap 3_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Informe de regresión lineal simple y múltiple cap 2 3 y ejercicio cap 3_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Informe de regresión lineal simple y múltiple cap 2 3 y ejercicio cap 3_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Informe de regresión lineal simple y múltiple cap 2 3 y ejercicio cap 3_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Informe de regresión lineal simple y múltiple: Resumen, Laboratorio Capítulos 2 y 3 ( An Introduction to Statistical Learning)</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Mariuxi Maribel Tenesaca Yuqui </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="capítulo-2-aprendizaje-estadístico" class="level2">
<h2 class="anchored" data-anchor-id="capítulo-2-aprendizaje-estadístico">Capítulo 2: Aprendizaje Estadístico</h2>
<p><em>El aprendizaje estadístico se refiere a un conjunto de enfoques para estimar f.</em></p>
<ul>
<li><p>Un ejemplo de un estudio de aprendizaje estadístico que investiga la correlación entre la publicidad y las ventas de productos en diferentes mercados.</p></li>
<li><p>Los datos de publicidad y ventas se tabulan y se busca un modelo preciso para pronosticar las ventas en función de los presupuestos de publicidad en televisión, radio y periódicos.</p></li>
<li><p>&nbsp;El presupuesto de publicidad es la variable de entrada (o independiente) etiquetada como X1, X2 y X3, mientras que las ventas son la variable de salida (o dependiente) etiquetada como Y.</p></li>
<li><p>Los términos “predictor”, “variable independiente”, “función” o simplemente “variable”. ” se usan indistintamente para referirse a la variable de entrada, mientras que la variable de salida también se puede llamar “respuesta” o “variable dependiente”.</p></li>
</ul>
<section id="por-qué-estimar-f" class="level3">
<h3 class="anchored" data-anchor-id="por-qué-estimar-f"><strong>¿Por qué estimar f?</strong></h3>
<p>Hay dos razones principales por las que podemos querer estimar f:</p>
<ol type="1">
<li><p>Predicción</p></li>
<li><p>Inferencia</p></li>
</ol>
<p><strong>Predicción</strong></p>
<p>En muchas situaciones, se dispone fácilmente de un conjunto de entradas X, pero la salida Y no puede obtenerse fácilmente.</p>
<p>En este caso, Dado que el término de error tiene un valor medio a cero, podemos predecir Y utilizando</p>
<p>Yˆ = ˆf(X),</p>
<ul>
<li><p>Donde ˆf representa nuestra estimación para f</p></li>
<li><p>Yˆ representa la predicción resultante para Y .</p></li>
<li><p>En este entorno, ˆf suele tratarse como una caja negra, en el sentido de que en el sentido de que a uno no le suele preocupar la forma exacta de ˆf, siempre y cuando produzca predicciones precisas para Y.</p></li>
</ul>
</section>
<section id="interferencia" class="level3">
<h3 class="anchored" data-anchor-id="interferencia"><strong>Interferencia</strong></h3>
<p>En este contexto, se puede predecir Y utilizando una estimación para f, y Y representa la predicción resultante para Y.</p>
<p>Si el objetivo es entender la asociación entre Y y X1,...,Xp, se debe estimar f, pero no necesariamente para hacer predicciones para Y. En este caso, no se puede tratar ˆf como una caja negra, ya que se necesita conocer su forma exacta.</p>
<p>Algunas preguntas que pueden surgir son:</p>
<ul>
<li>¿Qué predictores se asocian a la respuesta?</li>
</ul>
<p>&nbsp;A menudo que sólo una pequeña fracción de los predictores disponibles están con Y</p>
<ul>
<li>¿Cuál es la relación entre la respuesta y cada predictor?</li>
</ul>
<ol type="1">
<li><p>Algunos predictores pueden tener una relación positiva con Y.</p></li>
<li><p>La relación entre la respuesta y un predictor.</p></li>
<li><p>También puede depender de los valores de los demás predictores.</p></li>
</ol>
<ul>
<li>¿Puede resumirse adecuadamente la relación entre Y y cada predictor utilizando una ecuación lineal, o es la relación más complicada?</li>
</ul>
<p>Históricamente, la mayoría de los métodos para estimar f han adoptado una forma lineal.</p>
<p><em>En algunos casos, se pueden modelar la predicción y la inferencia.</em></p>
<p>Dependiendo del objetivo final de nuestro análisis, pueden ser apropiados diferentes métodos para estimar f.</p>
<ul>
<li>Por ejemplo, los modelos lineales permiten inferencias relativamente simples e interpretables, pero es posible que no proporcionen predicciones tan precisas como algunos métodos no lineales.</li>
</ul>
</section>
<section id="cómo-estimamos-f" class="level3">
<h3 class="anchored" data-anchor-id="cómo-estimamos-f"><strong>¿Cómo estimamos f?</strong></h3>
<p>Siempre supondremos que hemos observado un conjunto de n puntos de datos diferentes puntos de datos. Por ejemplo, en la Figura 1 observamos n = 30 puntos de datos.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/figura1.png" class="img-fluid figure-img" width="286"></p>
</figure>
</div>
<p>Estas observaciones se denominan datos de entrenamiento, ya se usarán para:</p>
<ul>
<li>Entrenar o enseñar.</li>
</ul>
<p>Para entrenar, o enseñar, a nuestro método a estimar f.</p>
<ul>
<li>yi representa la variable de respuesta de la i-ésima observación.</li>
</ul>
<p>Los datos de entrenamiento son:</p>
<ul>
<li>{(x1, y1),(x2, y2),...,(xn, yn)} donde xi = (xi1, xi2,...,xip)T .</li>
</ul>
<p>Nuestro objetivo es aplicar un método de aprendizaje estadístico a los datos de entrenamiento</p>
<p>para estimar la función desconocida f.</p>
<ul>
<li>Es decir encontrar una función ˆf tal que Y ≈ ˆf(X) para cualquier observación (X, Y ). En términos generales</li>
</ul>
</section>
<section id="métodos-paramétricos" class="level3">
<h3 class="anchored" data-anchor-id="métodos-paramétricos"><strong>Métodos paramétricos</strong></h3>
<p>Los métodos paramétricos implican un enfoque basado en modelos de dos pasos.</p>
<p><em>La forma funcional</em></p>
<p>Por ejemplo, una suposición muy sencilla es que f es lineal en X:</p>
<p>f(X) = β0 + β1X1 + β2X2 + --- + βpXp</p>
<p>Después de seleccionar un modelo, se necesita un procedimiento que use los datos de entrenamiento para ajustar o entrenar el modelo. En el caso del modelo lineal, necesitamos estimar los parámetros β0, β1,..., βp para encontrar los valores que ajusten los datos.</p>
<p>Es decir, queremos encontrar valores de estos parámetros tales que</p>
<p>Y ≈ β0 + β1X1 + β2X2 + --- + βpXp.</p>
<p>El enfoque más común para ajustar el modelo lineal es el método de mínimos cuadrados ordinarios.</p>
</section>
<section id="métodos-no-paramétricos" class="level3">
<h3 class="anchored" data-anchor-id="métodos-no-paramétricos"><strong>Métodos no paramétricos</strong></h3>
<p>Los métodos no paramétricos no hacen suposiciones explícitas sobre la forma funcional de f.</p>
<p>En su lugar, buscan una estimación de f que se acerque lo más posible a los puntos de datos sin que sea demasiado aproximada u ondulada.</p>
<p>Los puntos de datos sin ser demasiado aproximados o imprecisos.</p>
<p>Los enfoques no paramétricos no se hace ninguna suposición sobre la forma de f.&nbsp;Sin embargo, los enfoques no paramétricos tienen una gran desventaja.</p>
<p>Desventaja: dado que no reducen el problema de estimar f a un numero de parámetros, se necesita un gran número de observaciones (muchas más de las que se suelen necesitar para un método paramétrico).</p>
<p>En la Figura 2 se muestra un ejemplo de ajuste no paramétrico de los datos de ingresos.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/figura2.png" class="img-fluid figure-img" width="327"></p>
<p></p><figcaption class="figure-caption">En amarillo se muestra un ajuste suave de placa delgada a los datos de Ingresos.</figcaption><p></p>
</figure>
</div>
</section>
<section id="el-equilibrio-entre-la-precisión-de-la-predicción-y-la-interpretabilidad-del-modelo" class="level3">
<h3 class="anchored" data-anchor-id="el-equilibrio-entre-la-precisión-de-la-predicción-y-la-interpretabilidad-del-modelo"><strong>El equilibrio entre la precisión de la predicción y la interpretabilidad del modelo</strong></h3>
<ul>
<li><p>La regresión lineal es un enfoque relativamente inflexible, porque sólo puede generar funciones lineales.</p></li>
<li><p>Otros métodos, como los splines de placa delgada: Son considerablemente más flexibles porque pueden generar una gama de formas posibles para estimar f.</p></li>
</ul>
<p><strong>¿Por qué utilizar un método más restrictivo en lugar de un enfoque más flexible?</strong></p>
<p><em>Hay varias razones por las que podríamos preferir un modelo más restrictivo.</em></p>
<p>Si nos interesa principalmente la inferencia, los modelos restrictivos son mucho más interpretables.</p>
<ul>
<li>Por ejemplo, cuando el objetivo es la inferencia, el modelo lineal lineal puede ser una buena elección, ya que será bastante fácil entender la relación entre Y y X1, X2,...,Xp.</li>
</ul>
<p>En general, a medida que aumenta la flexibilidad de un método, disminuye su interpretabilidad.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/figura3.png" class="img-fluid figure-img" width="412"></p>
<p></p><figcaption class="figure-caption">Una representación del compromiso entre flexibilidad e interpretabilidad, utilizando diferentes métodos de aprendizaje estadístico.</figcaption><p></p>
</figure>
</div>
</section>
<section id="aprendizaje-supervisado-frente-a-aprendizaje-no-supervisado" class="level3">
<h3 class="anchored" data-anchor-id="aprendizaje-supervisado-frente-a-aprendizaje-no-supervisado"><strong>Aprendizaje supervisado frente a aprendizaje no supervisado</strong></h3>
<p>La mayoría de los problemas de aprendizaje estadístico pertenecen a una de estas dos categorías: <strong>supervisados o no supervisados</strong>.</p>
<ul>
<li>Para cada observación de predictor(es) xi, i = 1,...,n hay una medida de respuesta asociada yi de respuesta yi.</li>
</ul>
<p>Objetivo: Ajustar un modelo que relacione la respuesta con los predictores, con el fin de predecir con exactitud la respuesta para futuras de la (predicción) o comprender mejor la relación entre la respuesta y los predictores.</p>
<p><em>Métodos clásicos de aprendizaje estadístico que operan en el ámbito de la supervisión:</em></p>
<ol type="1">
<li><p>Regresión lineal</p></li>
<li><p>La regresión logística</p></li>
<li><p>GAM</p></li>
<li><p>Boosting</p></li>
<li><p>Máquinas de regresión de vec- soporte</p></li>
</ol>
<ul>
<li>El aprendizaje no supervisado describe la situación algo más difícil en la que para cada observación i = 1,...,n.</li>
</ul>
<p>Ejemplo: Un vector de medidas xi, pero ninguna respuesta asociada yi. No es posible ajustar un modelo de regresión lineal, ya que no existe una variable de respuesta</p>
<ul>
<li><p>En este contexto, en cierto modo trabajamos a ciegas</p></li>
<li><p>La situación se denomina no supervisada porque carecemos de una variable de respuesta que pueda supervisar nuestro análisis.</p></li>
</ul>
</section>
<section id="problemas-de-regresión-frente-a-problemas-de-clasificación" class="level3">
<h3 class="anchored" data-anchor-id="problemas-de-regresión-frente-a-problemas-de-clasificación"><strong>Problemas de regresión frente a problemas de clasificación</strong></h3>
<p>En estadística, las variables pueden ser cuantitativas o cualitativas (también conocidas como categóricas). Las variables cuantitativas toman valores numéricos, mientras que las variables cualitativas toman valores de diferentes categorías.</p>
<p>Los problemas con una variable de respuesta cuantitativa se denominan problemas de regresión, mientras que los problemas con una variable de respuesta cualitativa se denominan problemas de clasificación. Sin embargo, la distinción no siempre es clara, ya que en ambos casos se pueden utilizar ciertos métodos, como la regresión logística.</p>
<p>La elección del método de aprendizaje estadístico viene determinada por la variable respuesta (cuantitativa o cualitativa), mientras que el tipo de variable predictora (cualitativa o cuantitativa) se considera secundaria.</p>
<p>Independientemente del tipo de predictor, la mayoría de las técnicas de aprendizaje estadístico se pueden utilizar siempre que los predictores cualitativos estén codificados correctamente antes del análisis.</p>
</section>
<section id="evaluación-de-la-precisión-de-los-modelos" class="level3">
<h3 class="anchored" data-anchor-id="evaluación-de-la-precisión-de-los-modelos"><strong>Evaluación de la precisión de los modelos</strong></h3>
<p>Ningún método único es adecuado para todos los conjuntos de datos posibles, por lo que es importante elegir el método apropiado para cada conjunto de datos en particular.</p>
</section>
<section id="medir-la-calidad-del-ajuste" class="level3">
<h3 class="anchored" data-anchor-id="medir-la-calidad-del-ajuste"><strong>Medir la calidad del ajuste</strong></h3>
<p>Para evaluar el rendimiento de un método de aprendizaje estadístico en un conjunto de datos determinado, necesitamos algún modo de medir hasta qué punto sus predicciones:</p>
<p>Se necesita cuantificar hasta qué punto medida en que el valor de respuesta predicho para una observación dada se aproxima el verdadero valor de respuesta para esa observación.</p>
<p>En el ámbito de la regresión, la medida más utilizada es el error cuadrático medio (ECM), dado por:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/figura4.png" class="img-fluid figure-img" width="260"></p>
</figure>
</div>
<ul>
<li><p>ˆf(xi) es la predicción que da ˆf para la i-ésima observación. El MSE será pequeño si las respuestas predichas están muy cerca de las respuestas verdaderas.</p></li>
<li><p>Será grande si las respuestas pronosticadas y verdaderas para algunas observaciones difieren significativamente.</p></li>
</ul>
<p>El error cuadrático medio (MSE) se calcula utilizando los datos de entrenamiento utilizados para ajustar el modelo, por lo que debería llamarse MSE de entrenamiento con mayor precisión. Pero, en general, no nos importa qué tan bien funciona el método en los datos de entrenamiento.</p>
<p>En cambio, estamos interesados ​​en la precisión de las predicciones que obtenemos al aplicar nuestro método a datos de prueba nunca antes vistos. Esto es importante porque nos interesa cómo manejará el método los datos futuros, no cómo manejará los datos pasados ​​que se usaron para entrenar el modelo.</p>
<p>En la práctica, suele ser fácil calcular el MSE de entrenamiento:</p>
<ul>
<li><p>Estimar el MSE de prueba es mucho más difícil porque los datos de prueba generalmente no están disponibles.</p></li>
<li><p>El nivel de elasticidad correspondiente al modelo con el MSE de prueba más pequeño puede variar significativamente entre los conjuntos de datos.</p></li>
<li><p>Un enfoque importante es la validación cruzada, que es un método cruzado que utiliza datos de entrenamiento para estimar el MSE de una prueba.</p></li>
</ul>
</section>
<section id="la-relación-entre-sesgo-y-varianza" class="level3">
<h3 class="anchored" data-anchor-id="la-relación-entre-sesgo-y-varianza"><strong>La relación entre sesgo y varianza</strong></h3>
<p>Es posible demostrar que el MSE de prueba esperado, para un valor dado x0, siempre puede descomponerse en la suma de los valores de x0 y x0.</p>
<p>Siempre puede descomponerse en la suma de tres cantidades fundamentales: la varianza de ˆf(x0), el sesgo al cuadrado de ˆf(x0) y la varianza del error error ϵ. Es decir:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/figura5.png" width="367" height="38" class="figure-img"></p>
</figure>
</div>
<p>La notación E (Y0 - ˆf(x0) define el MSE de prueba esperado en x0, se refiere al MSE de prueba medio que obtendríamos si probáramos repetidamente MSE.</p>
<p>Se estima f utilizando un gran número de conjuntos de entrenamiento.</p>
<p>El término “varianza” se refiere a la cantidad en la que cambiaría la estimación de f si se usara un conjunto de datos de entrenamiento diferente para estimarla.</p>
<p>En general, los métodos estadísticos más flexibles marcan una mayor diferencia.</p>
<p>Si el método tiene una varianza alta, pequeños cambios en los datos de entrenamiento pueden causar grandes cambios en la estimación de ^f.</p>
<p>La mayor flexibilidad de un modelo estadístico afecta su varianza y sesgo y cómo esto afecta las pruebas de MSE.</p>
<p>A medida que aumenta la elasticidad, el sesgo tiende a disminuir más rápido que la varianza, lo que hace que disminuya el MSE de la prueba inicial. Pero después de cierto punto, la varianza aumenta significativamente y el MSE de la prueba comienza a aumentar.</p>
<p>La relación entre el sesgo, la varianza y el MSE del conjunto de prueba que se da en la ecuación y se muestra en la figura 6 se denomina compromiso sesgo-varianza.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/figura6-01.png" class="img-fluid figure-img" width="336"></p>
</figure>
</div>
<p>La relación entre sesgo y varianza es conocida como compromiso sesgo-varianza.</p>
<p>Para lograr un buen rendimiento del conjunto de prueba de un método de aprendizaje estadístico es necesario encontrar un equilibrio entre una varianza baja y un sesgo al cuadrado bajo. Esto es difícil de lograr ya que es fácil obtener métodos con baja varianza, pero alto sesgo o métodos con bajo sesgo, pero alta varianza.</p>
<p>Encontrar un método con ambos baja varianza y sesgo al cuadrado bajo es un desafío importante en el aprendizaje estadístico.</p>
<p><strong>El entorno de clasificación</strong></p>
<p>Muchos de los conceptos que hemos encontrado, como como el equilibrio entre sesgo y varianza, se transfieren al entorno de clasificación con sólo algunas modificaciones debidas al hecho de que yi ya no es cuantitativo.</p>
<p>Supongamos que queremos estimar f a partir de observaciones de entrenamiento {(x1, y1),...,(xn, yn)}, donde ahora y1,...,yn son cualitativas.</p>
<p>El enfoque más común para cuantificar la precisión de nuestra estimación ˆf es la tasa de error de entrenamiento, la proporción de errores que se cometen si aplicamos la tasa de error nuestra estimación ˆf a las observaciones de entrenamiento:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/figura7.png" class="img-fluid figure-img" width="178"></p>
</figure>
</div>
</section>
<section id="el-clasificador-de-bayes" class="level3">
<h3 class="anchored" data-anchor-id="el-clasificador-de-bayes"><strong>El clasificador de Bayes</strong></h3>
<p>Simplemente hay que asignar una observación de prueba con el vector predictor x0 a la clase j para la que:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/figura8.png" class="img-fluid figure-img" width="167"></p>
</figure>
</div>
<p>Es una probabilidad condicional: probabilidad de que Y = j, dado el vector predictor observado x0.</p>
<p>Este clasificador tan sencillo se denomina clasificador de Bayes. En un problema de dos clases en el que sólo hay dos posibles valores de respuesta, la clase 1 o la clase 2.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/figura9.png" class="img-fluid figure-img" width="272"></p>
<p></p><figcaption class="figure-caption">FIGURA 9. Un conjunto de datos simulados compuesto por 100 observaciones en cada uno de dos grupos, indicados en azul y en naranja. La línea discontinua morada representa el límite de decisión de Bayes.</figcaption><p></p>
</figure>
</div>
</section>
<section id="k-nearest-neighbors" class="level3">
<h3 class="anchored" data-anchor-id="k-nearest-neighbors"><strong>K-Nearest Neighbors</strong></h3>
<p>Los clasificadores de Bayes son buenos para predecir respuestas cualitativas, pero en realidad no conocemos la distribución condicional de Y dada X, por lo que no se puede calcular. Como tal, es un estándar de oro inalcanzable contra el cual comparar otros métodos.</p>
<p>&nbsp;Uno de estos métodos es el K-vecino más cercano (KNN), que estima la distribución condicional de Y dada X y clasifica las observaciones dadas según la clase con la probabilidad estimada más alta. Dado un entero K y una observación de prueba x0, el clasificador KNN identifica K puntos en los datos de entrenamiento que están más cerca de x0 y estima la probabilidad condicional de la clase j como la fracción N0 de puntos con un valor de respuesta igual A J.</p>
<p>A continuación, estima la probabilidad condicional de la clase j como la fracción de puntos en N0 cuyos valores de respuesta son iguales a j:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/figura10.png" class="img-fluid figure-img" width="245"></p>
</figure>
</div>
<p>El éxito de cualquier método de aprendizaje estadístico depende de elegir el nivel adecuado de flexibilidad tanto en la regresión como en la clasificación.</p>
<p>&nbsp;Esto implica lograr un equilibrio entre el sesgo y la varianza, lo que puede ser difícil debido a la forma de U del error de prueba.</p>
</section>
</section>
<section id="capítulo-3-regresión-lineal" class="level2">
<h2 class="anchored" data-anchor-id="capítulo-3-regresión-lineal"><strong>Capítulo 3: Regresión Lineal</strong></h2>
<p>La regresión lineal es una herramienta útil para predecir una respuesta cuantitativa</p>
<section id="regresión-lineal-simple" class="level3">
<h3 class="anchored" data-anchor-id="regresión-lineal-simple"><strong>Regresión lineal simple</strong></h3>
<p>La regresión lineal simple se enfoca para predecir una respuesta cuantitativa Y en función de una única variable predictora X. Supone que existe una relación aproximadamente lineal entre X e Y y se puede escribir esta relación matemáticamente como a continuación:</p>
<ul>
<li><em>Relación lineal: Y ≈ β0 + β1X</em></li>
</ul>
</section>
<section id="estimación-de-los-coeficientes" class="level3">
<h3 class="anchored" data-anchor-id="estimación-de-los-coeficientes"><strong>Estimación de los coeficientes</strong></h3>
<p>En la práctica, β0 y β1 son desconocidos. Así que antes de poder utilizar Y ≈ β0 + β1X para hacer</p>
<p>predicciones, debemos utilizar datos para estimar los coeficientes. Sea</p>
<p><em>(x1, y1), (x2, y2),..., (xn, yn)</em></p>
<p>Representan n pares de observaciones, cada uno de los cuales consiste en una medición de X y una medición de Y.</p>
<ul>
<li>Ejemplo: De publicidad, el conjunto de datos consiste en presupuestos de publicidad Televisión y ventas de productos para n=200 mercados diferentes. El objetivo es obtener los coeficientes de la ecuación lineal (3.1) para ajustar bien los datos disponibles. Esto se logra encontrando la intersección y la pendiente que el permitan dibujar una línea lo más cerca posible de los 200 puntos de datos. Para medir esta cercanía se utiliza el criterio de mínimos cuadrados, que se explica en este capítulo.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/figura11.png" class="img-fluid figure-img" width="396"></p>
<p></p><figcaption class="figure-caption">FIGURA 11. Para los datos de publicidad, se muestra el ajuste por mínimos cuadrados de la regresión de las ventas en la televisión. El ajuste se obtiene minimizando la suma de cuadrados residuales. cuadrados.</figcaption><p></p>
</figure>
</div>
</section>
<section id="evaluación-de-la-precisión-de-las-estimaciones-del-coeficiente" class="level3">
<h3 class="anchored" data-anchor-id="evaluación-de-la-precisión-de-las-estimaciones-del-coeficiente"><strong>Evaluación de la precisión de las estimaciones del coeficiente</strong></h3>
<p>Si f debe aproximarse mediante una función lineal, podemos escribir esta relación como:</p>
<p>Y = β0 + β1X + ϵ</p>
<ul>
<li><p>β0 es el término de intercepción, es decir, el valor esperado de Y cuando X = 0.</p></li>
<li><p>β1 es la pendiente, es decir, el aumento medio de Y asociado a un aumento de una unidad en X.</p></li>
<li><p>El término de error es un cajón de sastre para lo que no vemos con este método: la verdadera relación probablemente no sea lineal, puede haber otras variables que causen variación en Y , y puede haber error de medición.</p></li>
<li><p>Normalmente suponemos que el término de error es independiente de X.</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/figura12.png" class="img-fluid figure-img" width="395"></p>
<p></p><figcaption class="figure-caption">Figura 12. Un conjunto de datos simulados. Izquierda: La línea roja representa la relación verdadera, f(X)=2+3X, que se conoce como línea de regresión poblacional. La línea azul es la línea de mínimos cuadrados; es la estimación de mínimos cuadrados para f(X) basada en los datos observados, mostrados en negro.</figcaption><p></p>
</figure>
</div>
</section>
<section id="evaluación-de-la-precisión-del-modelo" class="level3">
<h3 class="anchored" data-anchor-id="evaluación-de-la-precisión-del-modelo"><strong>Evaluación de la precisión del modelo</strong></h3>
<p>Una vez rechazada la hipótesis nula en favor de la hipótesis alternativa, es natural querer cuantificar en qué medida el modelo se ajusta a los datos.</p>
<p>La calidad del ajuste de una regresión lineal suele evaluarse mediante dos magnitudes relacionadas: el error estándar residual (RSE) y el R2.</p>
</section>
<section id="error-estándar-residual" class="level3">
<h3 class="anchored" data-anchor-id="error-estándar-residual"><strong>Error estándar residual</strong></h3>
<p>Hay un término de error ϵ. Debido a la presencia de estos términos de error, aunque conociéramos la verdadera recta de regresión (es decir, aunque se conocieran β0 y β1), no podríamos predecir perfectamente Y a partir de X.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/fig13.png" class="img-fluid figure-img" width="289"></p>
</figure>
</div>
<p>El RSE es una estimación de la desviación típica de ϵ. A grandes rasgos, es la cantidad media en que la respuesta se desviará de la verdadera línea de regresión.</p>
<p>&nbsp;<strong>Se calcula mediante la fórmula:</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/fig14.png" class="img-fluid figure-img" width="266"></p>
</figure>
</div>
</section>
<section id="estadística-r2" class="level3">
<h3 class="anchored" data-anchor-id="estadística-r2"><strong>Estadística R2</strong></h3>
<p>El RSE proporciona una medida absoluta de la falta de ajuste del modelo a los datos. Pero como se mide en unidades de Y, no siempre está claro qué es un buen RSE.</p>
<p>El estadístico R2 proporciona una medida alternativa de ajuste. Adopta la forma de una proporción (la proporción de varianza explicada), por lo que siempre toma un valor entre 0 y 1, y es independiente de la escala de Y.</p>
<p><em>Para calcular R2, utilizamos la fórmula:</em></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/fig15.png" class="img-fluid figure-img" width="207"></p>
</figure>
</div>
<p>El estadístico R2 tiene una ventaja explicativa sobre el error estándar del residual (SSR) en que, a diferencia del RSE, siempre está entre 0 y 1. Sin embargo, sigue siendo difícil determinar qué es un buen valor para R2 y generalmente dependerá del uso particular.</p>
<p>Por ejemplo, en algunos problemas de física, se sabe que los datos en realidad provienen de un modelo lineal con residuos muy pequeños. En este caso, esperaría que un valor de R2 estuviera muy cerca de 1, mientras que un valor de R2 mucho más bajo podría indicar un problema grave en el experimento que generó los datos.</p>
</section>
<section id="regresión-lineal-múltiple" class="level3">
<h3 class="anchored" data-anchor-id="regresión-lineal-múltiple"><strong>Regresión lineal múltiple</strong></h3>
<p>Con la regresión lineal simple, la respuesta se puede predecir a partir de una sola variable predictora, pero en la práctica suele haber más de una.</p>
<p>Se puede realizar una regresión lineal simple para cada predictor para este propósito, pero no es del todo satisfactoria porque no permite un predictor y cada ecuación de regresión ignora los otros predictores.</p>
<p>Por el contrario, los modelos de regresión lineal simple se pueden ampliar para adaptarse a múltiples predictores al proporcionar coeficientes de pendiente separados para cada predictor en un solo modelo.</p>
<p>El modelo de regresión lineal adopta la forma:</p>
<p>Y = β0 + β1X1 + β2X2 + --- + βpXp + ϵ, (3.19)</p>
<p>Xj representa el j-ésimo predictor y βj cuantifica la asociación entre esa variable y la respuesta.</p>
<p>Interpretamos βj como el efecto medio efecto</p>
</section>
<section id="estimación-de-los-coeficientes-de-regresión" class="level3">
<h3 class="anchored" data-anchor-id="estimación-de-los-coeficientes-de-regresión"><strong>Estimación de los coeficientes de regresión</strong></h3>
<p>Como en el caso de la regresión lineal simple, los coeficientes de regresión β0, β1,..., βp en (3.19) son desconocidos y deben estimarse. Dada las estimaciones βˆ0, βˆ1,..., βˆp, podemos hacer predicciones utilizando la fórmula:</p>
<p>yˆ = βˆ0 + βˆ1x1 + βˆ2x2 + --- + βˆpxp</p>
<p>Los parámetros se estiman utilizando el mismo enfoque de mínimos cuadrados que vimos en el contexto de la regresión lineal simple. Elegimos β0, β1,..., βp para minimizar la suma de los residuos al cuadrado:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/fig16.png" class="img-fluid figure-img" width="233"></p>
</figure>
</div>
<p>Ejemplo de ajuste de mínimos cuadrados a un conjunto de datos con dos predictores.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/fig17.png" class="img-fluid figure-img" width="322"></p>
<p></p><figcaption class="figure-caption">Figura 17. En un entorno tridimensional, con dos predictores y una respuesta, la línea de regresión por mínimos cuadrados se convierte en un plano.</figcaption><p></p>
</figure>
</div>
<p>Los coeficientes que minimizan la ecuación son los estimados de los coeficientes de regresión de mínimos cuadrados múltiples. Estos estimados tienen formas complicadas que son más fácilmente representadas mediante álgebra matricial.</p>
</section>
<section id="algunas-cuestiones-importantes" class="level3">
<h3 class="anchored" data-anchor-id="algunas-cuestiones-importantes"><strong>Algunas cuestiones importantes</strong></h3>
<p>Cuando realizamos una regresión lineal múltiple, normalmente nos interesa responder a algunas preguntas importantes.</p>
<ol type="1">
<li><p>¿Es útil al menos uno de los predictores X1, X2,...,Xp para predecir la respuesta?</p></li>
<li><p>¿Ayudan todos los predictores a explicar Y o sólo es útil un subconjunto de los predictores?</p></li>
<li><p>¿En qué medida se ajusta el modelo a los datos?</p></li>
<li><p>Dado un conjunto de valores predictores, ¿qué valor de respuesta deberíamos predecir?</p></li>
<li><p>¿Cuál es la precisión de nuestra predicción?</p></li>
</ol>
<section id="existe-una-relación-entre-la-respuesta-y-los-predictores" class="level4">
<h4 class="anchored" data-anchor-id="existe-una-relación-entre-la-respuesta-y-los-predictores"><strong>¿Existe una relación entre la respuesta y los predictores?</strong></h4>
<p>En el marco de la regresión lineal simple, para determinar relación entre la respuesta y el predictor, basta con comprobar si β1 = 0.</p>
<p>Podemos simplemente comprobar si β1 = 0. En el escenario de regresión múltiple con p predictores, tenemos que preguntarnos si todos los coeficientes de regresión son cero, es decir, si β1 = β2 = --- = βp = 0.</p>
<p>Como en la regresión lineal simple, utilizamos una prueba de hipótesis para responder a esta pregunta. Probamos la hipótesis nula</p>
<p>H0 : β1 = β2 = --- = βp = 0</p>
<p>Frente a la alternativa Ha : al menos una βj es distinta de cero.</p>
<p>Esta prueba de hipótesis se realiza calculando el estadístico F, con lo siguiente:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/fig18.png" class="img-fluid figure-img" width="165"></p>
</figure>
</div>
<ul>
<li><p>Usar el estadístico F para probar cualquier relación entre el predictor y la respuesta es válido cuando p es relativamente pequeño y ciertamente pequeño en comparación con n.&nbsp;Pero a veces tenemos muchas variables. Si p&gt;n, entonces hay más coeficientes βj para estimar que observaciones para estimarlos.</p></li>
<li><p>En este caso, ni siquiera podemos ajustar Uno modelo de regresión lineal múltiple Usando mínimos cuadrados, por lo que no podemos usar el estadístico F ni la mayoría de los otros conceptos que hemos visto hasta ahora en este capítulo.</p></li>
<li><p>Sí p es grande, se pueden usar algunos de los métodos discutidos en la siguiente sección, como la selección hacia adelante.</p></li>
</ul>
</section>
<section id="variables-importantes" class="level4">
<h4 class="anchored" data-anchor-id="variables-importantes"><strong>Variables importantes</strong></h4>
<p>El capítulo presenta tres técnicas para la selección de variables en modelos de regresión múltiple:</p>
<ul>
<li><em>Selección hacia adelante, selección hacia atrás y selección mixta.</em></li>
</ul>
<p>En la selección directa, comenzamos con Uno modelo vacío y agregamos un predictor que minimiza el RSS. A continuación, agregue las variables predictoras que reducen el RSS al nuevo modelo bivariado. Este proceso continúa hasta que se cumple la regla de parada.</p>
<p>Con la selección posterior comenzamos con todos los predictores y eliminamos el predictor con el mayor valor de p, es decir, el predictor menos estadísticamente significativo. Este proceso continúa hasta que se cumple la regla de parada.</p>
<p>La selección mixta es una combinación de selección positiva y negativa. Comenzamos sin predictores en el modelo y agregamos predictores que brindan el mejor ajuste. Continuamos agregando predictores uno a la vez, y si en algún momento el valor p de un predictor aumenta más de un cierto umbral, ese predictor se elimina del modelo. Continuamos haciendo esto de un lado a otro hasta que todos los predictores en el modelo tengan valores p suficientemente bajos y todos los predictores fuera del modelo tengan valores p altos si se agregan al modelo.</p>
</section>
<section id="predicciones" class="level4">
<h4 class="anchored" data-anchor-id="predicciones"><strong>Predicciones</strong></h4>
<p>Una vez que hemos ajustado el modelo de regresión múltiple. Para predecir la respuesta Y a partir de un conjunto de valores de los predictores X1, X2, ...,Xp.</p>
<p>Sin embargo, hay tres tipos de incertidumbre asociada a esta predicción.</p>
<p>Las estimaciones de los coeficientes βˆ0, βˆ1,..., βˆp son estimaciones de β0, β1,..., βp.</p>
<p>Es decir, el plano de mínimos cuadrados</p>
<p><em>Yˆ = βˆ0 + βˆ1X1 + --- + βˆpXp</em></p>
<p>Es sólo una estimación del verdadero plano de regresión de la población</p>
<p><em>f(X) = β0 + β1X1 + --- + βpXp.</em></p>
<p>La inexactitud de las estimaciones de los coeficientes está relacionada con el error reducible.</p>
<p>Podemos calcular un intervalo de confianza para determinar lo cerca que estará <em>Yˆ de f(X).</em></p>
<p>En la práctica, asumir que un modelo lineal de f(X) eso casi siempre una aproximación de la realidad introduce una fuente adicional de error potencialmente reducible llamada sesgo del modelo. Usando el modelo lineal, estimamos la mejor aproximación lineal de la superficie real. Pero aquí ignoramos esta diferencia y actuamos como si el modelo lineal fuera correcto.</p>
</section>
</section>
<section id="predictores-cualitativos" class="level3">
<h3 class="anchored" data-anchor-id="predictores-cualitativos"><strong>Predictores cualitativos</strong></h3>
<p>Los predictores cualitativos se representan como variables ficticias en la tabla de datos. Describe cómo usar estas variables ficticias para modelar las relaciones entre los predictores cualitativos y las respuestas. Además, existen consideraciones especiales para el ajuste de modelos con predictores cuantitativos y cualitativos, incluida la interpretación de coeficientes.</p>
<section id="predictores-con-sólo-dos-niveles" class="level4">
<h4 class="anchored" data-anchor-id="predictores-con-sólo-dos-niveles"><strong>Predictores con sólo dos niveles</strong></h4>
<p>Si deseamos investigar las diferencias en el saldo de la tarjeta de crédito entre aquellos que poseen una casa y aquellos que no, podemos incorporar un predictor cualitativo o factor en nuestro modelo de regresión.</p>
<p>Si el factor solo tiene dos niveles o valores posibles, entonces es muy simple incorporarlo en el modelo. Simplemente creamos una variable indicadora o variable dummy que toma dos posibles valores numéricos.</p>
<p>Por ejemplo, en base a la variable own, podemos crear una nueva variable que tome la siguiente forma:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/f19.png" class="img-fluid figure-img" width="333"></p>
</figure>
</div>
<p>Utilizar esta variable como predictor en la ecuación de regresión. El resultado en el modelo:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/f20.png" width="353" height="47" class="figure-img"></p>
</figure>
</div>
<p>La figura 21 muestra el conjunto de datos de crédito contiene información sobre el saldo, la edad</p>
<p>tarjetas, educación, ingresos, límite y calificación de una serie de clientes potenciales</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/f21.png" class="img-fluid figure-img" width="308"></p>
<p></p><figcaption class="figure-caption">Figura 21. Datos credito</figcaption><p></p>
</figure>
</div>
</section>
<section id="predictores-cualitativos-con-más-de-dos-niveles" class="level4">
<h4 class="anchored" data-anchor-id="predictores-cualitativos-con-más-de-dos-niveles"><strong>Predictores cualitativos con más de dos niveles</strong></h4>
<p>Cuando un predictor cualitativo tiene más de dos niveles, una única variable ficticia no puede representar todos los valores posibles.</p>
<p>No puede representar todos los valores posibles. En esta situación, se debe crear variables ficticias adicionales.</p>
<p>Por ejemplo, para la variable región creamos dos variables ficticias:</p>
<p>La primera:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/f23.png" width="337" height="65" class="figure-img"></p>
</figure>
</div>
<p>La segunda:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/f24.png" class="img-fluid figure-img" width="301"></p>
</figure>
</div>
</section>
<section id="extensiones-del-modelo-lineal" class="level4">
<h4 class="anchored" data-anchor-id="extensiones-del-modelo-lineal"><strong>Extensiones del modelo lineal</strong></h4>
<p>Los modelos de regresión lineal estándar brindan resultados interpretables y funcionan bien para muchos problemas del mundo real. Sin embargo, contiene varios supuestos muy restrictivos que a menudo se violan en la práctica.</p>
<p>El supuesto de aditividad significa que la relación entre el predictor lineal X j y la respuesta Y es independiente de los valores de los otros predictores.</p>
<p>La suposición de linealidad establece que el cambio en la respuesta Y asociado con un cambio unitario en Xj es constante independientemente del valor de Xj.</p>
</section>
<section id="relaciones-no-lineales" class="level4">
<h4 class="anchored" data-anchor-id="relaciones-no-lineales"><strong>Relaciones no lineales</strong></h4>
<p>Los modelos de regresión lineal asumen una relación lineal entre la variable de respuesta y las variables predictoras, pero en algunos casos esta relación puede ser no lineal.</p>
<p>Para abordar esto, la regresión polinomial se puede utilizar como una forma sencilla de ampliar los modelos lineales y adaptarlos a condiciones no lineales.</p>
<p>Ampliar el modelo lineal para dar cabida a relaciones no lineales se conoce como regresión polinómica, ya que se incluye funciones polinómicas de los predictores en el modelo de regresión.</p>
</section>
<section id="problemas-potenciales" class="level4">
<h4 class="anchored" data-anchor-id="problemas-potenciales"><strong>Problemas potenciales</strong></h4>
<p>Cuando ajustamos un modelo de regresión lineal a un conjunto de datos concreto, pueden surgir muchos problemas. Los más comunes son los siguientes</p>
<p>1. No linealidad de las relaciones respuesta-predictor.</p>
<p>2. 2. Correlación de los términos de error.</p>
<p>3. Varianza no constante de los términos de error.</p>
<p>4. Valores atípicos.</p>
<p>5. Puntos de alto apalancamiento.</p>
<p>6. Colinealidad.</p>
</section>
<section id="ejemplo-datos-no-lineales" class="level4">
<h4 class="anchored" data-anchor-id="ejemplo-datos-no-lineales"><strong>Ejemplo: Datos no lineales</strong></h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/f25.png" class="img-fluid figure-img" width="417"></p>
<p></p><figcaption class="figure-caption">Figura 25. Gráficos de residuos frente a valores predichos (o ajustados) para el conjunto de datos Auto. En cada gráfico, la línea roja es un ajuste suave de los residuos, para facilitar la identificación de una tendencia.</figcaption><p></p>
</figure>
</div>
<p>Los modelos de regresión lineal asumen una relación lineal entre el predictor y las variables de respuesta. Si la verdadera relación está lejos de ser lineal, cualquier conclusión que saquemos del ajuste será sospechosa. Además, la precisión de predicción del modelo se reducirá significativamente.</p>
</section>
<section id="correlación-de-los-términos-de-error" class="level4">
<h4 class="anchored" data-anchor-id="correlación-de-los-términos-de-error"><strong>Correlación de los términos de error</strong></h4>
<p>Una suposición importante de los modelos de regresión lineal es que los términos de error ε1, ε2, ..., εn no están correlacionados.</p>
<ul>
<li><p>Esto significa que, por ejemplo, si los errores no están correlacionados, el hecho de que εi sea positivo proporciona poca o ninguna información sobre el signo de εi 1 .</p></li>
<li><p>Los errores estándar calculados para los coeficientes de regresión estimados o los valores ajustados se basan en la suposición de que los términos de error no están correlacionados.</p></li>
<li><p>Si de hecho existe una correlación entre los términos de error, el error estándar estimado suele subestimar el error estándar verdadero. Por lo tanto, los intervalos de confianza y predicción serán más estrechos de lo que deberían ser.</p></li>
</ul>
<p>En resumen, si los términos de error están correlacionados, es posible que tengamos una confianza indebida en nuestro modelo y que las conclusiones sean incorrectas.</p>
</section>
<section id="varianza-no-constante-de-los-términos-de-error" class="level4">
<h4 class="anchored" data-anchor-id="varianza-no-constante-de-los-términos-de-error"><strong>Varianza no constante de los términos de error</strong></h4>
<p>Otra suposición importante de los modelos de regresión lineal es que el término de error tiene una varianza constante Var(εi) = σ2.</p>
<p>Los errores estándar, los intervalos de confianza y la precisión de las pruebas de hipótesis se basan en esta suposición.</p>
<p>Desafortunadamente, a menudo sucede que la varianza del término de error no es constante. Por ejemplo:</p>
<ul>
<li><p>La varianza del término de error puede aumentar a medida que aumenta el valor de la respuesta. Ante este problema, una posible solución es transformar la respuesta Y utilizando una función cóncava como log Y o √Y.</p></li>
<li><p>Este cambio conduce a una mayor reducción de la heterocedasticidad. Un signo de heteroscedasticidad es la presencia de una forma de embudo en la gráfica de residuos.</p></li>
</ul>
</section>
<section id="valores-atípicos" class="level4">
<h4 class="anchored" data-anchor-id="valores-atípicos"><strong>Valores atípicos</strong></h4>
<p>Un valor atípico es un punto para el cual Yi está muy lejos del valor predicho por el modelo de valores atípicos.</p>
<p>Los valores atípicos pueden surgir por diversas razones, como la grabación incorrecta de una observación durante la recopilación de datos. Aunque a veces eliminar el valor atípico no afecta mucho la línea de ajuste por mínimos cuadrados, puede causar otros problemas, como:</p>
<ul>
<li><p>Un aumento dramático en el error estándar residual (RSE)</p></li>
<li><p>Una disminución en el coeficiente de determinación (R2)</p></li>
</ul>
<p>Esto puede tener implicaciones para la interpretación del ajuste y afectar la validez de las pruebas de hipótesis y los intervalos de confianza.</p>
</section>
<section id="puntos-de-alta-influencia" class="level4">
<h4 class="anchored" data-anchor-id="puntos-de-alta-influencia"><strong>Puntos de alta influencia</strong></h4>
<p>Las observaciones con alto nivel de influencia (high leverage) tienen un valor inusual para la variable predictora Xi, mientras que los valores de la variable respuesta Yi pueden ser bastante comunes.</p>
<p>La eliminación de estas observaciones puede tener un gran impacto en la línea de regresión estimada. Los puntos de alta influencia tienen un impacto considerable en la línea de regresión estimada y esto es motivo de preocupación si se sospecha que un punto tiene alta influencia.</p>
<p>Por lo tanto, es importante detectar y manejar adecuadamente las observaciones con alto nivel de influencia para evitar resultados erróneos en el análisis de regresión.</p>
</section>
<section id="colinealidad" class="level4">
<h4 class="anchored" data-anchor-id="colinealidad"><strong>Colinealidad</strong></h4>
<p>La colinealidad se refiere a la situación en la que dos o más variables predictoras están altamente correlacionadas entre sí.</p>
<p>La figura 26 muestra el concepto de colinealidad utilizando el conjunto de datos de préstamos, en el panel izquierdo de la figura, no existe una relación significativa entre las dos variables predictoras, límite y edad. Por el contrario, los predictores de ingresos y saldos en el panel derecho de la figura están altamente correlacionados, lo que indica un alto grado de colinealidad.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/f26.png" class="img-fluid figure-img" width="323"></p>
<p></p><figcaption class="figure-caption">Figura 26. Diagrama de dispersión de observaciones para el conjunto de datos de crédito.</figcaption><p></p>
</figure>
</div>
<p>La colinealidad puede causar problemas en la interpretación de los coeficientes de regresión y afectar la precisión de las estimaciones de los coeficientes y sus intervalos de confianza.</p>
<p>Una solución común para abordar la colinealidad es eliminar uno de los predictores altamente correlacionados o combinarlos en una sola variable utilizando técnicas como el análisis de componentes principales.</p>
</section>
<section id="comparación-de-la-regresión-lineal-con-k-nearest-neighbors" class="level4">
<h4 class="anchored" data-anchor-id="comparación-de-la-regresión-lineal-con-k-nearest-neighbors"><strong>Comparación de la regresión lineal con K-Nearest Neighbors</strong></h4>
<p>El enfoque paramétrico tiene ventajas como el fácil ajuste y la interpretación simple de los coeficientes. Sin embargo, también tienen la desventaja de que hacen fuertes suposiciones sobre la forma de f (X). Si esta forma es muy diferente de la realidad, es posible que el enfoque paramétrico no funcione bien. Por otro lado, los métodos no paramétricos claramente no asumen una forma paramétrica de f(X), lo que les da una elección más flexible.</p>
<p>Uno de los métodos no paramétricos más simples y conocidos es la regresión K-vecino más cercano (regresión KNN). El método identifica los puntos de entrenamiento K que están más cerca del punto predicho x0 y estima f(x0) como el promedio de las respuestas de entrenamiento en esos puntos.</p>
<p><em>¿En qué entorno un enfoque paramétrico como la regresión lineal de mínimos cuadrados superará a un enfoque no paramétrico como la regresión KNN?</em></p>
<ul>
<li>La respuesta es simple: El enfoque paramétrico superará al enfoque no paramétrico si la forma paramétrica que se ha seleccionado está cerca de la verdadera forma de F.</li>
</ul>
<p>Los métodos paramétricos tienden a superar a los métodos no paramétricos cuando hay pocas observaciones predictivas. Aunque en dimensiones pequeñas, la regresión lineal puede superar a KNN en términos de interpretabilidad.</p>
<p>Si la precisión de KNN es ligeramente menor que la de la regresión lineal, puede elegir un modelo simple que se pueda caracterizar por algunos coeficientes y donde los valores de p estén disponibles.</p>
</section>
</section>
</section>
<section id="capítulo-3-laboratorio-regresión-lineal" class="level2">
<h2 class="anchored" data-anchor-id="capítulo-3-laboratorio-regresión-lineal">Capítulo 3 Laboratorio: Regresión Lineal</h2>
<section id="bibliotecas" class="level3">
<h3 class="anchored" data-anchor-id="bibliotecas">Bibliotecas</h3>
<p>La función <strong>library()</strong>: se utiliza para cargar bibliotecas, o grupos de funciones y conjuntos de datos que no están incluidos en la base R distribución.</p>
<ul>
<li><p>Cargamos (MASA) paquete, que es una colección muy grande de conjuntos de datos y funciones.</p></li>
<li><p>También Cargamos el (ISLR2) paquete, que incluye los conjuntos de datos asociados con este libro.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (MASS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (ISLR2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ISLR2'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MASS':

    Boston</code></pre>
</div>
</div>
</section>
<section id="regresión-lineal-simple-1" class="level3">
<h3 class="anchored" data-anchor-id="regresión-lineal-simple-1"><strong>Regresión lineal simple</strong></h3>
<p>La biblioteca (ISLR2) contiene (Boston) conjunto de datos, que registra medv(valor medio de la casa) para 506 distritos censales en Boston.</p>
<p>Buscaremos predecir medv usando 12 predictores tales como rm(promedio de cuartos por casa), edad(edad promedio de las casas), ylstat(porcentaje de hogares con nivel socioeconómico bajo).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> (Boston)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     crim zn indus chas   nox    rm  age    dis rad tax ptratio lstat medv
1 0.00632 18  2.31    0 0.538 6.575 65.2 4.0900   1 296    15.3  4.98 24.0
2 0.02731  0  7.07    0 0.469 6.421 78.9 4.9671   2 242    17.8  9.14 21.6
3 0.02729  0  7.07    0 0.469 7.185 61.1 4.9671   2 242    17.8  4.03 34.7
4 0.03237  0  2.18    0 0.458 6.998 45.8 6.0622   3 222    18.7  2.94 33.4
5 0.06905  0  2.18    0 0.458 7.147 54.2 6.0622   3 222    18.7  5.33 36.2
6 0.02985  0  2.18    0 0.458 6.430 58.7 6.0622   3 222    18.7  5.21 28.7</code></pre>
</div>
</div>
<ol type="1">
<li><p>Para obtener más información sobre el conjunto de datos, podemos escribir.</p></li>
<li><p>La función lm() para ajustar un modelo de regresión lineal simple.</p></li>
<li><p>lm(), con medv como respuesta.</p></li>
<li><p>lstat como predictor.</p></li>
<li><p>La sintaxis básica es lm(y ∼ x, datos), donde y es la respuesta, x es el predictor y datos es el conjunto de datos en el que se mantienen estas dos variables.</p></li>
</ol>
<p><code>lm.fit &lt;- lm(medv ∼ lstat)</code> Error in eval(expr , envir , enclos) : Object “medv” not found <em>El comando genera un error porque R no sabe dónde encontrar las variables medv y lstat.</em></p>
<p>Adjuntamos Boston, la primera línea funciona bien porque R ahora reconoce las variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>lm.fit <span class="ot">&lt;-</span> <span class="fu">lm</span> ( medv<span class="sc">~</span>lstat , <span class="at">data =</span> Boston )</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span> ( Boston )</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>lm.fit <span class="ot">&lt;-</span> <span class="fu">lm</span> ( medv<span class="sc">~</span>lstat )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Si escribimos lm.fit, se genera información básica sobre el modelo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>lm.fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = medv ~ lstat)

Coefficients:
(Intercept)        lstat  
      34.55        -0.95  </code></pre>
</div>
</div>
<p>Para obtener información más detallada, utilizamos resumen (lm. ajuste).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span> (lm.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = medv ~ lstat)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.168  -3.990  -1.318   2.034  24.500 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 34.55384    0.56263   61.41   &lt;2e-16 ***
lstat       -0.95005    0.03873  -24.53   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.216 on 504 degrees of freedom
Multiple R-squared:  0.5441,    Adjusted R-squared:  0.5432 
F-statistic: 601.6 on 1 and 504 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>La función names() averigua qué otras piezas names() de información se almacenan en lm.fit.</p>
<ul>
<li>Aunque podemos extraer estas cantidades por su nombre -por ejemplo, lm.fit$coefficients- es más seguro utilizar las funciones extractoras como coef() para acceder a ellas.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span> (lm.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "coefficients"  "residuals"     "effects"       "rank"         
 [5] "fitted.values" "assign"        "qr"            "df.residual"  
 [9] "xlevels"       "call"          "terms"         "model"        </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span> (lm.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)       lstat 
 34.5538409  -0.9500494 </code></pre>
</div>
</div>
<p>El comando confint() se usa para obtener un intervalo de confianza para las estimaciones de los coeficientes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span> (lm.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                2.5 %     97.5 %
(Intercept) 33.448457 35.6592247
lstat       -1.026148 -0.8739505</code></pre>
</div>
</div>
<p>La función predict() puede utilizarse para producir intervalos de confianza e intervalos de predicción predict() para la predicción de medv para un valor dado de lstat.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(lm.fit , <span class="fu">data.frame</span>(<span class="at">lstat =</span> (<span class="fu">c</span>(<span class="dv">5</span> , <span class="dv">10</span> , <span class="dv">15</span>))) ,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="at">interval =</span> <span class="st">"confidence"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 29.80359 29.00741 30.59978
2 25.05335 24.47413 25.63256
3 20.30310 19.73159 20.87461</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(lm.fit , <span class="fu">data.frame</span>(<span class="at">lstat =</span> (<span class="fu">c</span>(<span class="dv">5</span> , <span class="dv">10</span> , <span class="dv">15</span>))) ,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="at">interval =</span> <span class="st">"prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit       lwr      upr
1 29.80359 17.565675 42.04151
2 25.05335 12.827626 37.27907
3 20.30310  8.077742 32.52846</code></pre>
</div>
</div>
<p>Ahora trazaremos medv y lstat junto con la línea de regresión por mínimos cuadrados utilizando las funciones plot() y abline().</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> ( lstat , medv )</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> ( lm.fit )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Informe-de-regresión-lineal-simple-y-múltiple-cap-2-3-y-ejercicio-cap-3_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><p>La función abline() puede utilizarse para trazar cualquier línea, no sólo la línea de regresión por mínimos cuadrados.</p></li>
<li><p>Para dibujar una línea con intercepto a y pendiente b, escribimos abline(a, b).</p></li>
<li><p>El comando lwd = 3 hace que la anchura de la línea de regresión se incremente en un factor de 3; esto funciona también para las funciones plot() y lines().</p></li>
<li><p>La opción pch para crear diferentes símbolos de trazado.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lstat , medv )</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(lm.fit, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(lm.fit, <span class="at">lwd=</span> <span class="dv">3</span> , <span class="at">col =</span> <span class="st">" red "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Informe-de-regresión-lineal-simple-y-múltiple-cap-2-3-y-ejercicio-cap-3_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lstat, medv , <span class="at">col =</span> <span class="st">" red "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Informe-de-regresión-lineal-simple-y-múltiple-cap-2-3-y-ejercicio-cap-3_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lstat, medv , <span class="at">pch =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Informe-de-regresión-lineal-simple-y-múltiple-cap-2-3-y-ejercicio-cap-3_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lstat, medv , <span class="at">pch =</span> <span class="st">" + "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Informe-de-regresión-lineal-simple-y-múltiple-cap-2-3-y-ejercicio-cap-3_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span> , <span class="at">pch =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Informe-de-regresión-lineal-simple-y-múltiple-cap-2-3-y-ejercicio-cap-3_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Se producen automáticamente cuatro gráficos de diagnóstico aplicando la función plot() directamente a la salida de lm().</p>
<p>En general, este comando producirá un gráfico cada vez, y al pulsar Intro se generará el siguiente gráfico. Sin embargo, a menudo es conveniente ver los cuatro gráficos juntos.</p>
<p>Las funciones par() y mfrow(), que indican a R que divida la pantalla de visualización en paneles separados de forma que se puedan visualizar varios gráficos simultáneamente.</p>
<ul>
<li><em>Por ejemplo, par(mfrow = c(2, 2)) divide la región de en una cuadrícula de paneles de 2 × 2.</em></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Informe-de-regresión-lineal-simple-y-múltiple-cap-2-3-y-ejercicio-cap-3_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Calcular los residuos de un ajuste de regresión lineal utilizando la función residuals().</p>
<p>La función rstudent() devolverá los residuales() rstudent() y podemos utilizar esta función para representar gráficamente los residuos frente a los valores ajustados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> ( <span class="fu">predict</span> (lm.fit), <span class="fu">residuals</span> (lm.fit))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Informe-de-regresión-lineal-simple-y-múltiple-cap-2-3-y-ejercicio-cap-3_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> ( <span class="fu">predict</span> (lm.fit), <span class="fu">rstudent</span> (lm.fit))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Informe-de-regresión-lineal-simple-y-múltiple-cap-2-3-y-ejercicio-cap-3_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Según los gráficos de residuos, hay indicios de no linealidad.</p>
<p>Los estadísticos de apalancamiento pueden calcularse para cualquier número de predictores utilizando la función <strong>hatvalues().</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> ( <span class="fu">hatvalues</span> (lm.fit))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Informe-de-regresión-lineal-simple-y-múltiple-cap-2-3-y-ejercicio-cap-3_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which.max</span> ( <span class="fu">hatvalues</span> (lm.fit))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>375 
375 </code></pre>
</div>
</div>
<p>La función which.max() identifica el índice del elemento mayor de un vector which.max().</p>
<p>En este caso, nos dice qué observación tiene el mayor estadístico de apalancamiento mayor.</p>
</section>
<section id="regresión-lineal-múltiple-1" class="level3">
<h3 class="anchored" data-anchor-id="regresión-lineal-múltiple-1"><strong>Regresión lineal múltiple</strong></h3>
<p>Para ajustar un modelo de regresión lineal múltiple por mínimos cuadrados, volvemos a utilizar la función utilizamos de nuevo la función lm().</p>
<p>La sintaxis lm (y ∼ x1 + x2 + x3) se utiliza para ajustar un modelo con tres predictores, x1, x2 y x3.</p>
<p>La función summary() muestra ahora los coeficientes de regresión de todos los predictores.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>lm.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> lstat <span class="sc">+</span> age, <span class="at">data =</span> Boston)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = medv ~ lstat + age, data = Boston)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.981  -3.978  -1.283   1.968  23.158 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 33.22276    0.73085  45.458  &lt; 2e-16 ***
lstat       -1.03207    0.04819 -21.416  &lt; 2e-16 ***
age          0.03454    0.01223   2.826  0.00491 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.173 on 503 degrees of freedom
Multiple R-squared:  0.5513,    Adjusted R-squared:  0.5495 
F-statistic:   309 on 2 and 503 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>El conjunto de datos de Boston contiene 12 variables, para realizar una regresión utilizar la siguiente abreviatura:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>lm.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> Boston)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = medv ~ ., data = Boston)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.1304  -2.7673  -0.5814   1.9414  26.2526 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  41.617270   4.936039   8.431 3.79e-16 ***
crim         -0.121389   0.033000  -3.678 0.000261 ***
zn            0.046963   0.013879   3.384 0.000772 ***
indus         0.013468   0.062145   0.217 0.828520    
chas          2.839993   0.870007   3.264 0.001173 ** 
nox         -18.758022   3.851355  -4.870 1.50e-06 ***
rm            3.658119   0.420246   8.705  &lt; 2e-16 ***
age           0.003611   0.013329   0.271 0.786595    
dis          -1.490754   0.201623  -7.394 6.17e-13 ***
rad           0.289405   0.066908   4.325 1.84e-05 ***
tax          -0.012682   0.003801  -3.337 0.000912 ***
ptratio      -0.937533   0.132206  -7.091 4.63e-12 ***
lstat        -0.552019   0.050659 -10.897  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.798 on 493 degrees of freedom
Multiple R-squared:  0.7343,    Adjusted R-squared:  0.7278 
F-statistic: 113.5 on 12 and 493 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Podemos acceder a los componentes individuales de un objeto resumen por su nombre (escriba resumen.lm para ver los componentes disponibles). Así, summary(lm.fit)$r.sq nos da el R2, y summary(lm.fit)$sigma nos da el RSE.</p>
<p>La función vif() vif(), que forma parte del paquete car, puede utilizarse para calcular los factores de inflación de la varianza.</p>
<p>La mayoría de los VIF son de bajos a moderados para estos datos.</p>
<p>El paquete car no forma parte de la instalación base de R, por lo que debe descargarse la primera vez que se utiliza a través de install.packages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(lm.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    crim       zn    indus     chas      nox       rm      age      dis 
1.767486 2.298459 3.987181 1.071168 4.369093 1.912532 3.088232 3.954037 
     rad      tax  ptratio    lstat 
7.445301 9.002158 1.797060 2.870777 </code></pre>
</div>
</div>
<p>¿Y si quisiéramos realizar una regresión utilizando todas las variables menos una?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>lm.fit1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> . <span class="sc">-</span> age, <span class="at">data =</span> Boston)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = medv ~ . - age, data = Boston)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.1851  -2.7330  -0.6116   1.8555  26.3838 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  41.525128   4.919684   8.441 3.52e-16 ***
crim         -0.121426   0.032969  -3.683 0.000256 ***
zn            0.046512   0.013766   3.379 0.000785 ***
indus         0.013451   0.062086   0.217 0.828577    
chas          2.852773   0.867912   3.287 0.001085 ** 
nox         -18.485070   3.713714  -4.978 8.91e-07 ***
rm            3.681070   0.411230   8.951  &lt; 2e-16 ***
dis          -1.506777   0.192570  -7.825 3.12e-14 ***
rad           0.287940   0.066627   4.322 1.87e-05 ***
tax          -0.012653   0.003796  -3.333 0.000923 ***
ptratio      -0.934649   0.131653  -7.099 4.39e-12 ***
lstat        -0.547409   0.047669 -11.483  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.794 on 494 degrees of freedom
Multiple R-squared:  0.7343,    Adjusted R-squared:  0.7284 
F-statistic: 124.1 on 11 and 494 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Como alternativa, puede utilizarse la función update().</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>lm.fit1 <span class="ot">&lt;-</span> <span class="fu">update</span>(lm.fit, <span class="sc">~</span> . <span class="sc">-</span> age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="términos-de-interacción" class="level3">
<h3 class="anchored" data-anchor-id="términos-de-interacción"><strong>Términos de interacción</strong></h3>
<p>Es fácil incluir términos de interacción en un modelo lineal utilizando la función lm()</p>
<p>La sintaxis lstat:black indica a R que incluya un término de interacción entre lstat y black.</p>
<p>La sintaxis lstat * edad incluye simultáneamente lstat, la edad.</p>
<p>El término de interacción lstat×edad como predictores; es una abreviatura de lstat + edad + lstat:edad.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span> (<span class="fu">lm</span>(medv<span class="sc">~</span>lstat <span class="sc">*</span> age , <span class="at">data =</span> Boston))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = medv ~ lstat * age, data = Boston)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.806  -4.045  -1.333   2.085  27.552 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 36.0885359  1.4698355  24.553  &lt; 2e-16 ***
lstat       -1.3921168  0.1674555  -8.313 8.78e-16 ***
age         -0.0007209  0.0198792  -0.036   0.9711    
lstat:age    0.0041560  0.0018518   2.244   0.0252 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.149 on 502 degrees of freedom
Multiple R-squared:  0.5557,    Adjusted R-squared:  0.5531 
F-statistic: 209.3 on 3 and 502 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="transformaciones-no-lineales-de-los-predictores" class="level3">
<h3 class="anchored" data-anchor-id="transformaciones-no-lineales-de-los-predictores"><strong>Transformaciones no lineales de los predictores</strong></h3>
<p>La función lm() también puede acomodar transformaciones no lineales de los predictores.</p>
<ul>
<li>Por ejemplo, dado un predictor X, podemos crear un predictor X2 utilizando I(X^2).</li>
</ul>
<p>La función I() es necesaria ya que el ^ tiene un significado especial I() en un objeto de fórmula; envolver como hacemos permite el uso estándar en R, que es elevar X a la potencia 2.</p>
<p>Ahora realizamos una regresión de medv sobre lstat y lstat2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>lm.fit2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> lstat <span class="sc">+</span> <span class="fu">I</span>(lstat<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = medv ~ lstat + I(lstat^2))

Residuals:
     Min       1Q   Median       3Q      Max 
-15.2834  -3.8313  -0.5295   2.3095  25.4148 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 42.862007   0.872084   49.15   &lt;2e-16 ***
lstat       -2.332821   0.123803  -18.84   &lt;2e-16 ***
I(lstat^2)   0.043547   0.003745   11.63   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.524 on 503 degrees of freedom
Multiple R-squared:  0.6407,    Adjusted R-squared:  0.6393 
F-statistic: 448.5 on 2 and 503 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>El valor p casi nulo asociado al término cuadrático sugiere que conduce a un modelo mejorado.</p>
<p>La función anova() para cuantificar mejor hasta qué punto el ajuste cuadrático es superior al lineal.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>lm.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> lstat)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm.fit, lm.fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: medv ~ lstat
Model 2: medv ~ lstat + I(lstat^2)
  Res.Df   RSS Df Sum of Sq     F    Pr(&gt;F)    
1    504 19472                                 
2    503 15347  1    4125.1 135.2 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>El Modelo 1 representa el submodelo lineal que contiene un solo predictor, lstat.</p>
<p>El Modelo 2 corresponde al modelo cuadrático más amplio que tiene dos predictores, lstat y lstat2.</p>
<p>La función anova() realiza una prueba de hipótesis compara los dos modelos. La hipótesis nula es que los dos modelos se ajustan igual de bien a los datos.</p>
<p>La hipótesis alternativa es que el modelo es superior.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm.fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Informe-de-regresión-lineal-simple-y-múltiple-cap-2-3-y-ejercicio-cap-3_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>La función poly() para crear el polinomio dentro de lm().</p>
<ul>
<li>Por ejemplo, el siguiente comando produce un ajuste polinómico de quinto orden:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>lm.fit5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> <span class="fu">poly</span>(lstat, <span class="dv">5</span>))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.fit5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = medv ~ poly(lstat, 5))

Residuals:
     Min       1Q   Median       3Q      Max 
-13.5433  -3.1039  -0.7052   2.0844  27.1153 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       22.5328     0.2318  97.197  &lt; 2e-16 ***
poly(lstat, 5)1 -152.4595     5.2148 -29.236  &lt; 2e-16 ***
poly(lstat, 5)2   64.2272     5.2148  12.316  &lt; 2e-16 ***
poly(lstat, 5)3  -27.0511     5.2148  -5.187 3.10e-07 ***
poly(lstat, 5)4   25.4517     5.2148   4.881 1.42e-06 ***
poly(lstat, 5)5  -19.2524     5.2148  -3.692 0.000247 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.215 on 500 degrees of freedom
Multiple R-squared:  0.6817,    Adjusted R-squared:  0.6785 
F-statistic: 214.2 on 5 and 500 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Esto sugiere que la inclusión de términos polinómicos adicionales, de hasta quinto orden,</p>
<p>mejora el ajuste del modelo. Sin embargo, un análisis más detallado de los datos revela que ningún término polinómico más allá del quinto orden tiene valores p significativos en un ajuste de regresión.</p>
<p>Por defecto, la función poly() ortogonaliza los predictores.</p>
<p>Para obtener los polinomios brutos de la función poly(), debe utilizarse el argumento raw = TRUE.</p>
<p>Ejemplo de aplicación de una transformación logarítmica:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(medv <span class="sc">~</span> <span class="fu">log</span>(rm), <span class="at">data =</span> Boston))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = medv ~ log(rm), data = Boston)

Residuals:
    Min      1Q  Median      3Q     Max 
-19.487  -2.875  -0.104   2.837  39.816 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -76.488      5.028  -15.21   &lt;2e-16 ***
log(rm)       54.055      2.739   19.73   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.915 on 504 degrees of freedom
Multiple R-squared:  0.4358,    Adjusted R-squared:  0.4347 
F-statistic: 389.3 on 1 and 504 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="predictores-cualitativos-1" class="level3">
<h3 class="anchored" data-anchor-id="predictores-cualitativos-1"><strong>Predictores cualitativos</strong></h3>
<p>A continuación, examinaremos los datos de Asientos de seguridad, que forman parte de la biblioteca ISLR2.</p>
<p>Intentaremos predecir las ventas (ventas de sillas de coche para niños) en 400 localidades basándonos en una serie de predictores.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Carseats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sales CompPrice Income Advertising Population Price ShelveLoc Age Education
1  9.50       138     73          11        276   120       Bad  42        17
2 11.22       111     48          16        260    83      Good  65        10
3 10.06       113     35          10        269    80    Medium  59        12
4  7.40       117    100           4        466    97    Medium  55        14
5  4.15       141     64           3        340   128       Bad  38        13
6 10.81       124    113          13        501    72       Bad  78        16
  Urban  US
1   Yes Yes
2   Yes Yes
3   Yes Yes
4   Yes Yes
5   Yes  No
6    No Yes</code></pre>
</div>
</div>
<p>Los datos de Carseats incluyen predictores cualitativos como Shelveloc, un indicador de la calidad de la ubicación de la estantería -es decir, el espacio de la tienda en el que se expone la silla- en cada establecimiento.</p>
<p>El predictor Shelveloc adopta tres valores posibles: Malo, Medio y Bueno.</p>
<p>Dada una variable cualitativa como Shelveloc, R genera variables ficticias automáticamente.</p>
<p>A continuación, ajustamos un modelo de regresión múltiple que incluye algunos términos de interacción.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>lm.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sales <span class="sc">~</span> . <span class="sc">+</span> Income<span class="sc">:</span>Advertising <span class="sc">+</span> Price<span class="sc">:</span>Age, <span class="at">data =</span> Carseats)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sales ~ . + Income:Advertising + Price:Age, data = Carseats)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.9208 -0.7503  0.0177  0.6754  3.3413 

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         6.5755654  1.0087470   6.519 2.22e-10 ***
CompPrice           0.0929371  0.0041183  22.567  &lt; 2e-16 ***
Income              0.0108940  0.0026044   4.183 3.57e-05 ***
Advertising         0.0702462  0.0226091   3.107 0.002030 ** 
Population          0.0001592  0.0003679   0.433 0.665330    
Price              -0.1008064  0.0074399 -13.549  &lt; 2e-16 ***
ShelveLocGood       4.8486762  0.1528378  31.724  &lt; 2e-16 ***
ShelveLocMedium     1.9532620  0.1257682  15.531  &lt; 2e-16 ***
Age                -0.0579466  0.0159506  -3.633 0.000318 ***
Education          -0.0208525  0.0196131  -1.063 0.288361    
UrbanYes            0.1401597  0.1124019   1.247 0.213171    
USYes              -0.1575571  0.1489234  -1.058 0.290729    
Income:Advertising  0.0007510  0.0002784   2.698 0.007290 ** 
Price:Age           0.0001068  0.0001333   0.801 0.423812    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.011 on 386 degrees of freedom
Multiple R-squared:  0.8761,    Adjusted R-squared:  0.8719 
F-statistic:   210 on 13 and 386 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>La función contrasts() devuelve la codificación que R utiliza para las variables ficticias contrasts().</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(Carseats)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(ShelveLoc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Good Medium
Bad       0      0
Good      1      0
Medium    0      1</code></pre>
</div>
</div>
<p>El hecho de que el coeficiente de ShelveLocGood en el resultado de la regresión sea positivo indica que una buena estantería se asocia a ventas elevadas (en comparación con las malas).</p>
<p>Y ShelveLocMedium tiene un coeficiente positivo menor, lo que indica que una la ubicación media de las estanterías se asocia a mayores ventas que una mala ubicación, pero a menores ventas que una buena ubicación.</p>
</section>
<section id="escribir-funciones" class="level3">
<h3 class="anchored" data-anchor-id="escribir-funciones"><strong>Escribir funciones</strong></h3>
<p>Escribir nuestra propia función. Por ejemplo, a continuación:</p>
<p>Una función sencilla que lee las bibliotecas ISLR2 y MASS, llamada LoadLibraries(). Antes de que hayamos creado la función, R devuelve un error si intentamos llamarla.</p>
<p><code>LoadLibraries Error: object ‘LoadLibraries ’ not found LoadLibraries() Error: could not find function "LoadLibraries"</code></p>
<p><strong>Ahora creamos la función</strong></p>
<ul>
<li><p>El símbolo { informa a R que varios comandos están a punto de ser introducidos. Si pulsa Intro después de escribir {, R imprimirá el símbolo +.</p></li>
<li><p>Podemos entonces introducir tantos comandos como deseemos, pulsando Enter después de cada uno.</p></li>
<li><p>Finalmente el símbolo } informa a R que no se introducirán más comandos serán introducidos.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>LoadLibraries <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR2)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Las bibliotecas han sido cargadas."</span>)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Ahora si tecleamos LoadLibraries, R nos dirá qué contiene la función.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>LoadLibraries</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>function() {
library(ISLR2)
library(MASS)
print("Las bibliotecas han sido cargadas.")
}</code></pre>
</div>
</div>
<ul>
<li>Si llamamos a la función, las librerías se cargan y la sentencia print se imprime.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">LoadLibraries</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Las bibliotecas han sido cargadas."</code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>